[2025-05-30T16:04:12.518+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: movie_recommendation_pipeline.build_features manual__2025-05-30T15:59:05.906637+00:00 [queued]>
[2025-05-30T16:04:12.523+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: movie_recommendation_pipeline.build_features manual__2025-05-30T15:59:05.906637+00:00 [queued]>
[2025-05-30T16:04:12.524+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-05-30T16:04:12.533+0000] {taskinstance.py:2191} INFO - Executing <Task(PythonOperator): build_features> on 2025-05-30 15:59:05.906637+00:00
[2025-05-30T16:04:12.543+0000] {standard_task_runner.py:60} INFO - Started process 715 to run task
[2025-05-30T16:04:12.545+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'movie_recommendation_pipeline', 'build_features', 'manual__2025-05-30T15:59:05.906637+00:00', '--job-id', '44', '--raw', '--subdir', 'DAGS_FOLDER/mlops_movie_dag.py', '--cfg-path', '/tmp/tmp17qouy4l']
[2025-05-30T16:04:12.547+0000] {standard_task_runner.py:88} INFO - Job 44: Subtask build_features
[2025-05-30T16:04:12.580+0000] {task_command.py:423} INFO - Running <TaskInstance: movie_recommendation_pipeline.build_features manual__2025-05-30T15:59:05.906637+00:00 [running]> on host 1f4894b62cf1
[2025-05-30T16:04:12.636+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='movie_recommendation_pipeline' AIRFLOW_CTX_TASK_ID='build_features' AIRFLOW_CTX_EXECUTION_DATE='2025-05-30T15:59:05.906637+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-05-30T15:59:05.906637+00:00'
[2025-05-30T16:04:28.601+0000] {local_task_job_runner.py:121} ERROR - Received SIGTERM. Terminating subprocesses
[2025-05-30T16:04:28.607+0000] {process_utils.py:131} INFO - Sending 15 to group 715. PIDs of all processes in the group: [715]
[2025-05-30T16:04:28.623+0000] {process_utils.py:86} INFO - Sending the signal 15 to group 715
[2025-05-30T16:04:29.703+0000] {taskinstance.py:2450} ERROR - Received SIGTERM. Terminating subprocesses.
[2025-05-30T16:04:29.718+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/operators/python.py", line 199, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/operators/python.py", line 216, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/src/features/build_features.py", line 72, in main
    user_matrix = create_user_matrix(ratings, movies)
  File "/opt/airflow/src/features/build_features.py", line 63, in create_user_matrix
    user_matrix = movie_ratings.groupby("userId").agg(
  File "/home/airflow/.local/lib/python3.10/site-packages/pandas/core/groupby/generic.py", line 895, in aggregate
    result = op.agg()
  File "/home/airflow/.local/lib/python3.10/site-packages/pandas/core/apply.py", line 169, in agg
    return self.apply_str()
  File "/home/airflow/.local/lib/python3.10/site-packages/pandas/core/apply.py", line 580, in apply_str
    return self._try_aggregate_string_function(obj, f, *self.args, **self.kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/pandas/core/apply.py", line 649, in _try_aggregate_string_function
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/pandas/core/groupby/groupby.py", line 2183, in mean
    result = self._cython_agg_general(
  File "/home/airflow/.local/lib/python3.10/site-packages/pandas/core/groupby/groupby.py", line 1810, in _cython_agg_general
    new_mgr = data.grouped_reduce(array_func, ignore_failures=ignore_failures)
  File "/home/airflow/.local/lib/python3.10/site-packages/pandas/core/internals/managers.py", line 1527, in grouped_reduce
    applied = blk.apply(func)
  File "/home/airflow/.local/lib/python3.10/site-packages/pandas/core/internals/blocks.py", line 351, in apply
    result = func(self.values, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/pandas/core/groupby/groupby.py", line 1791, in array_func
    result = self.grouper._cython_operation(
  File "/home/airflow/.local/lib/python3.10/site-packages/pandas/core/groupby/ops.py", line 1039, in _cython_operation
    return cy_op.cython_operation(
  File "/home/airflow/.local/lib/python3.10/site-packages/pandas/core/groupby/ops.py", line 708, in cython_operation
    return self._cython_op_ndim_compat(
  File "/home/airflow/.local/lib/python3.10/site-packages/pandas/core/groupby/ops.py", line 527, in _cython_op_ndim_compat
    return self._call_cython_op(
  File "/home/airflow/.local/lib/python3.10/site-packages/pandas/core/groupby/ops.py", line 579, in _call_cython_op
    func(
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 2452, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
airflow.exceptions.AirflowException: Task received SIGTERM signal
[2025-05-30T16:04:29.734+0000] {taskinstance.py:1138} INFO - Marking task as UP_FOR_RETRY. dag_id=movie_recommendation_pipeline, task_id=build_features, execution_date=20250530T155905, start_date=20250530T160412, end_date=20250530T160429
[2025-05-30T16:04:29.749+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 44 for task build_features (Task received SIGTERM signal; 715)
[2025-05-30T16:04:29.815+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=715, status='terminated', exitcode=1, started='16:04:11') (715) terminated with exit code 1
[2025-05-30T16:04:29.816+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 143
[2025-05-30T16:04:29.844+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
